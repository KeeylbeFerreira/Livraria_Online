<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Livraria do Ke ‚Äî In√≠cio</title>
    <meta name="description" content="Descubra seu pr√≥ximo livro favorito.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700;900&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>

<header class="header">
  <nav class="nav container" aria-label="Principal">
    <a class="brand" href="Pag01.html">
      <img src="assets/img/logo-livraria.png" alt="Logo Livraria do Ke">
      <span>Livraria do Ke</span>
    </a>
    <button class="burger" aria-label="Abrir menu">‚ò∞</button>
    <div class="nav-links">
      <a href="Pag01.html" aria-current="page">In√≠cio</a>
      <a href="Catalogo.html">Cat√°logo</a>
      <a href="sobre.html">Sobre</a>
      <a href="index.html" id="link-entrar">Entrar</a> <!-- ser√° oculto se logado -->
    </div>
    <!-- ‚ö†Ô∏è dei um id para manipular via JS -->
    <div class="nav-cta" id="user-area">
      <a class="btn btn-outline" href="Catalogo.html">Explorar</a>
    </div>
  </nav>
</header>

<section class="hero">
  <div class="container content">
    <div>
      <h1>Descubra seu <span style="color:#ffd36a">pr√≥ximo livro favorito</span>.</h1>
      <p>Uma curadoria com os t√≠tulos mais pedidos de fic√ß√£o, neg√≥cios, tecnologia e muito mais.</p>
      <form action="Catalogo.html" class="searchbar" role="search" aria-label="Buscar no cat√°logo">
        <input id="q" name="q" type="search" placeholder="Busque por t√≠tulo ou autor‚Ä¶" aria-label="Buscar por t√≠tulo ou autor">
        <button class="btn btn-primary" type="submit">Buscar</button>
      </form>
      <div style="margin-top:1rem; color:#dbe6f4">Dica: use o filtro por categorias dentro do Cat√°logo.</div>
    </div>
    <div>
      <img src="assets/img/Gif-Livro.gif" alt="Anima√ß√£o de livros em movimento">
    </div>
  </div>
</section>

<section class="section">
  <div class="container">
    <h2>Destaques da Semana</h2>
    <div id="home-destaques" class="grid cols-4"></div>
  </div>
</section>

<footer class="footer">
  <div class="container cols">
    <div>
      <a class="brand" href="Pag01.html">
        <img src="assets/img/logo-livraria.png" alt="Logo Livraria do Ke">
        <span>Livraria do Ke</span>
      </a>
      <p>Leitura que inspira. Atendimento humanizado e entrega para todo o Brasil.</p>
      <small>¬© 2025 Livraria do Ke. Todos os direitos reservados.</small>
    </div>
    <div>
      <strong>Links</strong><br>
      <a href="Catalogo.html">Cat√°logo</a><br>
      <a href="sobre.html">Sobre</a><br>
      <a href="index.html" aria-current="page">Entrar</a>
    </div>
    <div>
  <strong>Contato</strong>
  <ul class="contact-list">
    <li class="contact">
      <img src="assets/img/icone_gmail.png" alt="" aria-hidden="true">
      <span>contato@livrariadoke.com</span>
    </li>
    <li class="contact">
      <img src="assets/img/icone_whats.png" alt="" aria-hidden="true">
      <span>(00) 00000-0000</span>
    </li>
  </ul>
</div>

</footer>
<div class="toast" role="status" aria-live="polite"></div>

<!-- üí° Script r√°pido: mostra nome, esconde "Entrar" e adiciona "Sair" -->
<script>
  (function(){
    const userArea = document.getElementById('user-area');
    const linkEntrar = document.getElementById('link-entrar');
    const current = JSON.parse(localStorage.getItem('ldk_current_user') || 'null');

    if (!userArea) return;

    if (current && (current.name || current.email)) {
      // oculta "Entrar"
      if (linkEntrar) linkEntrar.style.display = 'none';

      const firstName = (current.name || current.email || 'Usu√°rio').split(' ')[0];

      // "Ol√°, Nome" como pill usando a classe .chip do seu CSS
      const hello = document.createElement('span');
      hello.className = 'chip';
      hello.textContent = `Ol√°, ${firstName}`;

      // bot√£o Sair
      const logout = document.createElement('button');
      logout.className = 'btn btn-outline';
      logout.type = 'button';
      logout.textContent = 'Sair';
      logout.addEventListener('click', () => {
        localStorage.removeItem('ldk_current_user');
        location.reload();
      });

      // opcional: atalho para cat√°logo continua
      const explorar = document.createElement('a');
      explorar.className = 'btn';
      explorar.href = 'Catalogo.html';
      explorar.textContent = 'Explorar';

      userArea.innerHTML = '';
      userArea.append(hello, explorar, logout);
    }
  })();
</script>

<!-- Render dos destaques (usa seus dados em ./js/books.js) -->
<script type="module">
  import { BOOKS, generateCoverDataURL } from './js/books.js';

  const grid = document.querySelector('#home-destaques');

  const cardHTML = (b) => {
    const cover = b.cover ?? generateCoverDataURL(b.title, b.author);
    return `
      <article class="card" data-id="${b.id}">
        <div class="card-media">
          <img data-id="${b.id}" src="${cover}" alt="Capa de ${b.title}">
        </div>
        <div class="card-body">
          <div class="card-title">${b.title}</div>
          <div class="card-sub">${b.author}</div>
          <div class="card-actions">
            <a class="btn btn-primary" href="leitura.html?id=${encodeURIComponent(b.id)}">Ler</a>
          </div>
        </div>
      </article>`;
  };

  function attachCoverFallback(root) {
    root.querySelectorAll('img[data-id]').forEach(img => {
      img.addEventListener('error', () => {
        const b = BOOKS.find(x => x.id === img.dataset.id);
        if (b) img.src = generateCoverDataURL(b.title, b.author);
      }, { once: true });
    });
  }

  function sample(arr, n){ return arr.slice().sort(() => 0.5 - Math.random()).slice(0, n); }
  const destaques = sample(BOOKS, Math.min(4, BOOKS.length));

  grid.innerHTML = destaques.map(cardHTML).join('');
  attachCoverFallback(grid);
</script>

</body>
</html>
