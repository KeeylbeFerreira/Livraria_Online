<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Leitura — Livraria do Ke</title>
  <meta name="description" content="Ambiente de leitura com conforto visual.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700;900&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <style>
    /* ajustes visuais do leitor PDF */
    .pdf-frame{
      width:100%;
      height:82vh;
      border:1px solid #e6e8ef;
      border-radius:12px;
      background:#fff;
      box-shadow:0 10px 26px rgba(13,42,74,.08);
    }
    .reader-header{ display:flex; align-items:center; gap:.75rem; flex-wrap:wrap }
    .reader-header h2{ margin:0 }
    .reader-meta{ color:var(--muted) }
    .reader-actions{ display:flex; gap:.5rem; flex-wrap:wrap }

    /* modo foco: esconde header/rodapé p/ leitura */
    body.is-focus .header,
    body.is-focus .footer { display:none }
    body.is-focus .pdf-frame{ height: calc(100vh - 48px) }

    /* largura cheia do container */
    .reader-shell.is-wide .reader-body{ max-width:none }
    .reader-shell.is-wide .pdf-frame{ height: 88vh }
  </style>
</head>
<body>

<header class="header">
  <nav class="nav container" aria-label="Principal">
    <a class="brand" href="Pag01.html">
      <img src="assets/img/logo-livraria.png" alt="Logo Livraria do Ke">
      <span>Livraria do Ke</span>
    </a>
    <button class="burger" aria-label="Abrir menu">☰</button>
    <div class="nav-links">
      <a href="Pag01.html">Início</a>
      <a href="Catalogo.html">Catálogo</a>
      <a href="sobre.html">Sobre</a>
      <a href="index.html">Entrar</a>
    </div>
  </nav>
</header>

<main class="section">
  <div class="container">
    <div class="reader-shell theme-light" id="reader-shell">
      <!-- Topo do leitor -->
      <div class="reader-top">
        <div class="reader-header">
          <a class="btn" href="Catalogo.html">← Voltar</a>
          <h2 id="book-title">Carregando…</h2>
          <span id="book-meta" class="reader-meta">—</span>
        </div>
        <div class="reader-actions">
          <button class="btn" id="focus-toggle" title="Modo foco (F)">Modo foco</button>
          <button class="btn" id="wide-toggle" title="Largura cheia (W)">Largura cheia</button>
          <a class="btn btn-outline" id="download-link" href="#" download>Baixar PDF</a>
          <a class="btn" id="newtab-link" href="#" target="_blank" rel="noopener">Abrir em nova aba</a>
        </div>
      </div>

      <!-- Corpo do leitor -->
      <div class="reader-body" style="grid-template-columns: 1fr; max-width: 1120px; margin: 0 auto;">
        <section class="reader-main">
          <div style="margin-top:.75rem">
            <!-- PDF sem a barra do visualizador nativo -->
            <iframe id="pdf" class="pdf-frame" title="Leitor de PDF"></iframe>
          </div>
        </section>
      </div>
    </div>
  </div>
</main>

<footer class="footer">
  <div class="container cols">
    <div>
      <a class="brand" href="Pag01.html">
        <img src="assets/img/logo-livraria.png" alt="Logo Livraria do Ke">
        <span>Livraria do Ke</span>
      </a>
      <p>Leitura que inspira. Atendimento humanizado e entrega para todo o Brasil.</p>
      <small>© 2025 Livraria do Ke. Todos os direitos reservados.</small>
    </div>
    <div>
      <strong>Links</strong><br>
      <a href="Catalogo.html">Catálogo</a><br>
      <a href="sobre.html">Sobre</a><br>
      <a href="index.html">Entrar</a>
    </div>
    <div>
      <strong>Contato</strong><br>
      <a href="mailto:contato@livrariadoke.com">contato@livrariadoke.com</a><br>
      <a href="tel:+550000000000">(00) 00000-0000</a>
    </div>
  </div>
</footer>

<script type="module">
  import { BOOKS } from './js/books.js';

  const params = new URLSearchParams(location.search);
  const id = params.get('id');

  const titleEl = document.getElementById('book-title');
  const metaEl  = document.getElementById('book-meta');
  const frame   = document.getElementById('pdf');
  const dlLink  = document.getElementById('download-link');
  const tabLink = document.getElementById('newtab-link');
  const shell   = document.getElementById('reader-shell');

  const book = BOOKS.find(b => b.id === id);

  if (!book) {
    titleEl.textContent = 'Livro não encontrado';
    metaEl.textContent  = 'Verifique o link ou retorne ao catálogo.';
  } else {
    titleEl.textContent = book.title;
    metaEl.textContent  = `${book.author}${book.genres ? ' • ' + book.genres.join(' • ') : ''}`;

    // caminho do PDF (codificando nome para suportar espaços/acentos)
    const fileName = encodeURIComponent(book.file);
    const path = `assets/books/${fileName}`;

    // abre no iframe sem toolbar; "FitH" deixa largura ajustada
    frame.src = `${path}#toolbar=0&navpanes=0&view=FitH`;

    // ações
    dlLink.href  = path;
    dlLink.setAttribute('download', `${book.title}.pdf`);
    tabLink.href = path;
  }

  // Modo foco (esconde header/footer)
  const focusBtn = document.getElementById('focus-toggle');
  focusBtn.addEventListener('click', () => {
    document.body.classList.toggle('is-focus');
  });
  // atalho F
  document.addEventListener('keydown', (e) => {
    if (e.key.toLowerCase() === 'f') focusBtn.click();
  });

  // Largura cheia do leitor
  const wideBtn = document.getElementById('wide-toggle');
  wideBtn.addEventListener('click', () => {
    shell.classList.toggle('is-wide');
  });
  // atalho W
  document.addEventListener('keydown', (e) => {
    if (e.key.toLowerCase() === 'w') wideBtn.click();
  });
</script>
</body>
</html>
